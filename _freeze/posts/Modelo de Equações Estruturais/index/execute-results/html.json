{
  "hash": "7d588220b2adaf2bcc99a6fa2338bbc4",
  "result": {
    "markdown": "---\ntitle: \"Modelo de Equações Estruturais\"\nauthor: \"Caio Lopes\"\ndate: \"2025-07-17\"\ncategories: [Aulas]\nimage: \"image.jpg\"\n---\n\n\n# Descrição\n\nEste material aborda os Modelos de Equações Estruturais (MEE) ou *Structural Equation Model* (SEM)\n\n# Plano de aula\n\n[Visualizar Plano de Aula Completo](Plano_de_Aula_SEM.pdf){target=\"_blank\"}\n\n# Introdução\n\n## O que é o SEM?\n\nA Modelagem de Equações Estruturais (SEM) é uma metodologia para testar e estimar relações causais entre múltiplas variáveis.\n\n::: callout-note\n## Observação Importante\n\n**O SEM pode ser entendido como uma combinação de 2 técnicas e trabalha essencialmente com 2 tipos de variáveis**\n:::\n\n-   **Das técnicas**: O SEM pode ser visto como uma combinação da:\n\n1.  **Análise fatorial**, que busca mesurar **variáveis latentes** por meio de variáveis observadas;\n\n2.  **Análise de regressão**, que analisa as inter-relações das variáveis.\n\n### Sobre a Análise Fatorial\n\nA análise fatorial pode ser dividida em dois tipos principais: exploratória e confirmatória.\n\n-   A **Análise Fatorial Exploratória** é utilizada quando o pesquisador não possui uma teoria pré-existente forte ou uma hipótese clara sobre a estrutura subjacente de um conjunto de variáveis. O objetivo da AFE é identificar e entender os traços latentes (também chamados de fatores ou construtos) que podem explicar as correlações observadas entre um grande número de variáveis manifestas (itens de um questionário, por exemplo)\n\n-   **A análise fatorial confirmatória** empresta muitos dos mesmos conceitos da análise fatorial exploratória, exceto que, em vez de deixar os dados nos dizerem a estrutura fatorial, nós pré-determinamos a estrutura fatorial. É geralmente baseada em pesquisas anteriores, teorias estabelecidas ou no próprio resultado de uma AFE prévia.\n\n**A análise fatorial confirmatória - ou confirmatory factor analysis (CFA) - faz parte frequentemente da abordagem abrangente do SEM**\n\nUm modelo SEM é geralmente representado por um diagrama que mostra as relações hipotéticas entre: **Variáveis Latentes** e **Variáveis Observadas**\n\n-   **Variáveis Latentes**: Conceitos abstratos que não podem ser medidos diretamente (ex: bem-estar, inteligência, burnout).\n\n-   **Variáveis Observadas (ou Indicadores)**: Dados que podem ser medidos diretamente e que servem como indicadores das variáveis latentes (ex: respostas a perguntas de um questionário).\n\n## Por que utilizar o SEM?\n\n**Visão Holística do Modelo** Use a SEM para testar um sistema completo de relações de uma só vez. Em vez de analisar cada hipótese separadamente (o que aumenta o risco de erro), a SEM avalia se o seu modelo teórico como um todo é compatível com os dados, oferecendo uma visão global e integrada do fenômeno.\n\n**Medição Precisa de Conceitos Abstratos** A SEM é ideal para medir conceitos abstratos (variáveis latentes) como \"satisfação\" ou \"ansiedade\". Ela faz isso usando múltiplos indicadores (perguntas de um questionário) e, crucialmente, separa a medição do conceito do seu erro de medição. Isso resulta em estimativas muito mais confiáveis das relações entre as variáveis.\n\n## Quando usar o SEM?\n\nA Modelagem de Equações Estruturais é uma ferramenta estatística confirmatória, não exploratória. Ela pode ser aplicada de três maneiras distintas:\n\nI.  *Confirmação Direta*: Testar um único modelo teórico para validá-lo ou invalidá-lo.\n\nII. *Modelos Alternativos*: Comparar modelos concorrentes para ver qual explica melhor os dados.\n\nIII. *Desenvolvimento do Modelo*: Iniciar com um modelo teórico e, caso ele não se ajuste bem, modificá-lo em busca de uma versão melhor e mais simples (parcimoniosa).\n\n## Vantagem do SEM\n\nOs Modelos de Equações Estruturais englobam uma ampla gama de abordagens:\n\n-   **Regressão linear e multivariada**\n-   **Análise de trajetória (path analysis)**\n-   **Análise fatorial confirmatória (CFA)**\n-   **Regressão estrutural** (relacionar variáveis latentes)\n\nEssa capacidade de integração é o que torna a SEM tão poderosa, permitindo:\n\n-   **Medir e quantificar relações entre conceitos abstratos e dados concretos**\n\n-   **Transformar relações complexas em diagramas visuais compreensíveis**\n\n-   **Computar efeitos diretos e indiretos de uma variável sobre a outra**\n\n## Breve histórico do SEM\n\n-   Um dos principais autores (talvez o principal) do SEM foi **Karl Joreskög** (Seus artigos seminais datam da década de 1970)\n\n    -   Propôs a metodologia CFA via máxima verossimilhança e análise da matriz de variância-covariancia\n\n    -   Colaborou para o desenvolvimento do diagrama de caminho\n\n    -   Ele foi um dos responsáveis pelo desenvolvimento do software LISREL para modelagem de equações estruturais no início da década de 1970\n\n**Charles Spearman** e **Sewall Wright** são creditados com os primeiros modelos (análise fatorial e análise de caminho) que influenciaram diretamente o desenvolvimento do SEM\n\nYves Rosseel desenvolveu o pacote lavaan de código aberto para o R\n\nAtualmente, **Judea Pearl** é um grande defensor da interpretação causal dos parametros estimados via SEM\n\n-   A abordagem de resultados potenciais é amplamente reconhecida como a principal abordagem para inferência causal nas Ciências Econômicas.\n\n![](pearl_imbens.png)\n\n# Conceitos e a Caixa de Ferramentas\n\nPara trabalhar com SEM, é essencial compreender seus componentes e a terminologia específica.\n\nEste quadro-resumo apresenta os principais termos utilizados em Modelagem de Equações Estruturais (SEM) de forma concisa e visual.\n\n| Termo | Definição | Exemplo |\n|:-----------------------|:-----------------------|:-----------------------|\n| **Variável Observada** | Variável que **existe no banco de dados**, diretamente medida ou coletada. Também chamada de **item** ou **variável manifesta**. | Resposta a \"Qual sua nota em matemática?\" ou \"De 1 a 5, quão satisfeito você está?\". |\n| **Variável Latente** | **Conceito abstrato não medido diretamente**, inferido a partir de variáveis observadas. | \"Inteligência\", \"Ansiedade\", \"Satisfação no Trabalho\". |\n| **Variável Exógena** | **Variável independente** no modelo, funciona como \"causa\" e não é explicada por outras variáveis no modelo. | Ponto de partida de uma seta causal. |\n| **Variável Endógena** | **Variável dependente** no modelo, funciona como \"efeito\" e é explicada por outras variáveis no modelo. | Destino de uma seta causal. |\n| **Modelo de Mensuração** | Parte do SEM que **conecta variáveis observadas a variáveis latentes**, definindo como os conceitos abstratos são medidos. | Especificar que Q1, Q2 e Q3 são indicadores de \"Ansiedade\". |\n| **Indicador** | **Variável observada usada para medir uma variável latente** em um modelo de mensuração. | \"Nota em geometria\" como medida de \"habilidade matemática\". |\n| **Fator** | Outro nome para **variável latente**, definida por seus indicadores. | \"Inteligência\" como fator medido por testes de QI. |\n| **Carga Fatorial** | Caminho que **liga um indicador ao seu fator**, representando a força dessa relação. | Uma carga fatorial alta indica que o item é um bom medidor do conceito. |\n| **Modelo Estrutural** | Parte do SEM que **especifica relações de causa e efeito entre variáveis** (latentes ou observadas). | Definir \"Ansiedade → Desempenho Acadêmico\". |\n\n## Variáveis Observadas vs. Variáveis Latentes\n\nNo SEM, distinguimos entre dois tipos principais de variáveis: **Variáveis Observadas**: São variáveis que **existem diretamente nos dados** e podem ser medidas sem erro.\n\n**Variáveis Latentes**: São variáveis **construídas que não existem diretamente nos dados**; são hipóteses teóricas. Elas são mensuradas indiretamente através de suas variáveis observadas (indicadores) por meio de análise fatorial confirmatória\n\nAlém disso, as variáveis podem ser classificadas como:\n\n**Variável Exógena**: Uma variável **independente** que explica uma variável endógena. Pode ser observada (representada por 'x') ou latente (representada por '$\\xi$').\n\n**Variável Endógena**: Uma variável **dependente** que é explicada por outras variáveis no modelo. Pode ser observada (representada por 'y') ou latente (representada por '$\\eta$'). Em modelos de análise de trajetória, uma variável endógena pode predizer outra variável endógena.\n\n## Diagramas de Caminho ou Diagramas de Trajetória\n\nOs **diagramas de trajetória** são representações visuais essenciais dos modelos SEM, facilitando a compreensão das relações complexas que podem ser difíceis de visualizar apenas com equações matriciais.\n\n![Exemplo de diagrama de trajetória](legenda_diagrama.png)\n\nOs símbolos utilizados nos diagramas são padronizados:\n\n-   **Círculos**: Representam **variáveis latentes** (fatores ou construtos).\n-   **Quadrados**: Representam **variáveis observadas** (indicadores ou itens).\n-   **Triângulos**: Representam **interceptos** ou médias (geralmente não explicitados por padrão no `lavaan` a menos que solicitados).\n-   **Setas únicas (de uma via)**: Indicam **caminhos de regressão** ou relações causais diretas (ex: uma variável predizendo outra).\n-   **Setas duplas (de duas vias)**: Indicam **variâncias** (se a seta aponta para a própria variável, formando um loop) ou **covariâncias** (se a seta conecta duas variáveis).\n\n## Modelo de Mensuração e Modelo Estrutural\n\nO SEM é singular por abranger tanto **modelos de medida ou de mensuração** quanto **modelos estruturais**:\n\n-   **Modelo de Mensuração**: É a parte do SEM que **liga variáveis observadas a variáveis latentes**. Sua função é mensurar construtos latentes a partir de variáveis observadas. Envolve a **Análise Fatorial Confirmatória (AFC)**.\n    -   Neste modelo, as variáveis observadas que medem um fator são chamadas de **indicadores**.\n    -   Um fator (variável latente) é definido por seus indicadores. A relação entre um indicador e um fator é chamada de **carga fatorial (loading)**.\n-   **Modelo Estrutural**: A parte do SEM que **especifica as relações causais entre variáveis**, sejam elas observadas ou latentes. Pode envolver relações de variáveis exógenas para endógenas, e até mesmo de variáveis endógenas para outras variáveis endógenas.\n    -   O tipo mais abrangente de modelo estrutural, a **regressão estrutural**, lida com as relações entre **variáveis latentes**.\n\n## Estimação, Identificação e Teste de Modelos (Goodness-of-Fit)\n\nPara entender os conceitos de estimação, identificação e teste de ajuste de modelos tomaremos como exemplo um modelo de mensuração.\n\n### O modelo de mensuração\n\nO **modelo de mensuração** ou modelo de análise fatorial é essencialmente um modelo de regressão linear onde o preditor principal, o fator, é latente ou não observado. Para um único *item*, o modelo de análise fatorial é:\n\n$$y_1 = \\tau_1 + \\lambda_1\\eta + \\epsilon_1$$\n\nonde $\\tau_1$ é o intercepto do primeiro item e $\\lambda_1$ é a carga ou peso de regressão do primeiro fator sobre o primeiro item, e $\\epsilon_1$ é o termo de erro para o primeiro item. Existem duas diferenças principais entre o modelo de análise fatorial e a regressão linear:\n\n-   \n\n    1.  A primeira e mais importante é que o preditor ou fator, $\\eta$ (\"eta\"), não é observado, enquanto em uma regressão linear os preditores são observados.\n\n-   \n\n    2.  A análise fatorial tende a ser um modelo multivariado: vários itens (resultados) por indivíduo)\n\nPodemos representar um modelo mensuração (com 3 itens) como uma equação matricial:\n\n$$\\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} \\tau_1 \\\\ \\tau_2 \\\\ \\tau_3 \\end{pmatrix} + \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\\\ \\lambda_3 \\end{pmatrix} (\\eta) + \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\epsilon_3 \\end{pmatrix}$$\n\nVamos definir cada um dos termos no modelo:\n\n-   $\\tau$ (\"tau\") os **interceptos** ou médias dos itens\n-   $\\lambda$ (\"lambda\") as **cargas**, que podem ser interpretadas como a correlação do item com o fator\n-   $\\eta$ (\"eta\"), o preditor latente dos itens, ou seja, o **fator**\n-   $\\epsilon$ (\"epsilon\") os **resíduos** do modelo fatorial, o que sobra depois de considerar o fator ou o que explica o item além do fator\n\nO índice refere-se ao número do item. Assim, por exemplo, $\\tau_1$ significa o intercepto do primeiro item, $\\lambda_2$ é a carga do segundo item com o fator e $\\epsilon_3$ é o resíduo do terceiro item, após considerar o fator.\n\n## A Matriz de Covariância Implícita no Modelo\n\nHistoricamente, a análise fatorial é usada para responder à pergunta: quanta **variância** comum é compartilhada entre os itens? Esta matriz de variância-covariância pode ser descrita usando a **matriz de covariância implícita no modelo** $\\Sigma(\\theta_{y})$. Note que isso contrasta com a **matriz de covariância populacional observada** $\\Sigma$, que vem apenas dos dados. A fórmula para a matriz de covariância implícita no modelo é:\n\n$$\\Sigma(\\theta_{y}) = \\Lambda\\Psi\\Lambda' + \\Theta_\\epsilon$$\n\nA seguir, a descrição de cada **parâmetro**, definido como um termo no modelo a ser estimado:\n\n-   $\\Lambda$ (\"lambda\") matriz de **cargas fatoriais** (consistindo dos mesmos $\\lambda$'s do modelo de mensuração)\n-   $\\Psi$ (\"psi\") matriz de **variância-covariância dos fatores latentes** (ou seja, variância de $\\eta$; para um fator, é um escalar)\n-   $\\Theta_\\epsilon$ (\"theta-epsilon\") matriz de **variância-covariância dos erros**\n\nAs dimensões desta matriz correspondem às mesmas da matriz de covariância observada $\\Sigma$; para três itens, é 3x3. Lembre-se que a matriz de covariância do modelo pode ser definida pelo seguinte:\n\nNo caso de três itens e um fator:\n\n$$\\Sigma(\\theta_y) = \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\\\ \\lambda_3 \\end{pmatrix} (\\psi_{11}) \\begin{pmatrix} \\lambda_1 & \\lambda_2 & \\lambda_3 \\end{pmatrix} + \\begin{pmatrix} \\theta_{11} & \\theta_{12} & \\theta_{13} \\\\ \\theta_{21} & \\theta_{22} & \\theta_{23} \\\\ \\theta_{31} & \\theta_{32} & \\theta_{33} \\end{pmatrix}$$\n\nNote que as cargas $\\lambda$ são os mesmos parâmetros compartilhados entre o modelo de mensuração e a matriz de covariância implícita. Isso significa que os únicos novos parâmetros envolvem $\\Psi$ e $\\Theta_\\epsilon$, que são as matrizes de covariância dos fatores latentes e dos erros, respectivamente.\n\nUsualmente negligenciamos os interceptos ($\\tau$'s) do modelo estrutural (raramente possui uma interpretação útil). Para isso, o pesquisador padroniza os itens (subtrai a média e divide pelo desvio-padrão).\n\n## Valores Conhecidos, Parâmetros, Graus de Liberdade e Identificação\n\nO conceito de parâmetro fixo ou livre é essencial na CFA (Análise Fatorial Confirmatória). O número total de parâmetros em um modelo CFA é determinado pelo número de **valores conhecidos** em sua matriz de variância-covariância populacional $\\Sigma$, dada pela fórmula $p(p+1)/2$, onde $p$ é o número de itens em sua pesquisa. Para obter a matriz de covariância amostral $S = \\hat{\\Sigma}$, que é uma estimativa da matriz de covariância populacional $\\Sigma$, use o comando `cov` no `R`.\n\nAs células fora da diagonal em $S$ correspondem às **covariâncias amostrais** entre dois pares de itens; e as células diagonais em $S$ correspondem à **variância amostral** de cada item.\n\nComo as covariâncias são duplicadas, o número de parâmetros livres na CFA é determinado pelo número de variâncias e covariâncias **únicas**. Com três itens, o número de valores conhecidos é $3(4)/2 = 6$.\n\nOs valores conhecidos servem como a restrição principal em termos de quantos parâmetros **totais** podemos estimar. Para simplificar, vamos assumir que o número total de parâmetros vem **apenas** da matriz de covariância implícita no modelo. Dado que temos 6 valores conhecidos, quantos parâmetros totais (únicos) temos da matriz de covariância implícita no modelo (com 3 itens e 1 fator latente)?\n\n$$\\Sigma(\\theta) = \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\\\ \\lambda_3 \\end{pmatrix} (\\psi_{11}) \\begin{pmatrix} \\lambda_1 & \\lambda_2 & \\lambda_3 \\end{pmatrix} + \\begin{pmatrix} \\theta_{11} & \\theta_{12} & \\theta_{13} \\\\ \\theta_{21} & \\theta_{22} & \\theta_{23} \\\\ \\theta_{31} & \\theta_{32} & \\theta_{33} \\end{pmatrix}$$\n\nSe fôssemos estimar cada parâmetro na matriz de covariância implícita no modelo, haveria 3 $\\lambda$'s, 1 $\\psi$, e 6 $\\theta$'s, o que nos dá um total de 10 parâmetros, mas temos apenas 6 valores conhecidos! A solução é permitir **parâmetros fixos**, que são parâmetros pré-determinados.\n\nN$^{o}$ **de parâmetros livres** = N$^{o}$ **de parâmetros de interesse** - N$^{o}$ **de parâmetros fixos**.\n\n**df** = N$^{o}$ **de valores conhecidos** - N$^{o}$ **de parâmetros livres**\n\n-   Os modelos são **justamente identificados** ou **saturados** com zero graus de liberdade. Isso significa que o número de parâmetros livres ocupa todos os valores conhecidos em $\\Sigma$. Isso é comumente visto em modelos de regressão linear, e a principal desvantagem é que não podemos avaliar o ajuste do modelo porque ele supostamente é o melhor que podemos fazer.\n\n-   Um **modelo subidentificado** significa que o número de valores conhecidos é menor que o número de parâmetros livres, o que é indesejável.\n\n-   Em **modelos superidentificados**, o número de valores conhecidos é maior que o número de parâmetros livres. Modelos superidentificados nos permitem avaliar o ajuste do modelo (a ser discutido posteriormente). Para resumir:\n\n-   df negativo, valores conhecidos \\< parâmetros livres\n\n-   df = 0, valores conhecidos = parâmetros livres\n\n-   df positivo, valores conhecidos \\> parâmetros livres\n\nUsualmente existem 2 formas de garantir a identificação do modelo:\n\n-   \n\n    1.  **Método do Marcador**: Fixa a **primeira carga fatorial de cada fator em 1**. Este é o método padrão no `lavaan` .\n\n-   \n\n    2.  **Método de Padronização da Variância** : Fixa a **variância de cada fator em 1**, mas estima livremente todas as cargas fatoriais.\n\n::: callout-note\n## Observação Importante\n\n**Se for do interesse do pesquisador encontrar os valores dos interceptos ele terá problema de identificação?**\n\n**Resposta**: Não. Apesar dos parâmetros de interesse aumentarem, o número de valores conhecidos também irá aumentar, pois a matriz de variância-covariância amostral deverá incorporar os vetores de 1's dos interceptos\n:::\n\n### Estimação\n\nNo SEM, os modelos são tipicamente estimados utilizando o método de **Máxima Verossimilhança (ML)**. A ML busca os parâmetros que tornam a amostra observada mais provável, ou seja, maximiza a função de verossimilhança para determinar os parâmetros que têm maior probabilidade de produzir os dados observados.\n\nÉ importante notar que, embora os coeficientes de regressão de uma estimação por Mínimos Quadrados Ordinários (MQO) sejam equivalentes aos da Máxima Verossimilhança, as estimativas das variâncias do modelo diferem entre os 2 estimadores.\n\nO componente mais essencial de um modelo de equações estruturais é a **matriz de covariância**. O objetivo do SEM é **reproduzir a matriz de covariância da população** ($\\Sigma$), usando os parâmetros que o modelo hipotetiza ($\\Sigma(\\theta)$), pela matriz de covariância implicita do modelo. Se o modelo se ajusta perfeitamente, então $\\Sigma = \\Sigma(\\theta)$.\n\nNa prática, a função máxima verossimilhança busca os valores dos parâmetros de interesse que maximizam a probabilidade de que a matriz de covariância amostral ($\\Sigma$) coincida com a matriz de covariância implícita do modelo ($\\Sigma(\\theta)$).\n\n### Estatísticas de Qualidade do Ajuste (Model Fit Statistics)\n\nAs estatísticas de qualidade do ajuste avaliam o quão bem o modelo populacional se ajusta aos dados observados. A hipótese nula no SEM é que **a matriz de covariância implicada pelo modelo (**$\\Sigma(\\theta)$) é igual à matriz de covariância da população ($\\Sigma$) ($H_0: \\Sigma(\\theta)=\\Sigma$). Rejeitar esta hipótese é geralmente **indesejável** no SEM, pois significaria que o modelo proposto não se ajusta bem aos dados.\n\n-   **Covariância Residual**: A diferença entre a matriz de covariância amostral ($S$) e a matriz de covariância implicada pelo modelo ($\\Sigma(\\hat{\\theta})$), ou seja, $S - \\Sigma(\\hat{\\theta})$. Valores próximos de zero indicam um bom ajuste.\n\n-   **Teste Qui-quadrado do Modelo (**$\\chi^2$): É a estatística de teste principal que mede a discrepância entre a matriz de covariância observada e a matriz de covariância implicada pelo modelo.\n\n    -   Um **valor de qui-quadrado maior indica uma maior diferença** (pior ajuste) entre as matrizes e, consequentemente, uma maior probabilidade de rejeitar a hipótese nula .\n\n-   Por ser um teste sensível ao tamanho da amostra é comum a utilização de outros testes incrementais (comparativos):\n\n    -   CFI (Comparative Fit Index)\n    -   TLI (Tucker Lewis Index)\n\n# Aplicações do SEM na Economia\n\nO SEM, com sua capacidade de modelar relações complexas e variáveis latentes, tem diversas aplicações.\n\n## Exemplos de Aplicações\n\nDois exemplos de aplicação, retirados de Neves (2018) são:\n\n1)  **Modelo de Realização de Status Socioeconômico**: Um modelo da teoria da estratificação social que investiga como a origem socioeconômica (variáveis como escolaridade dos pais e status socioeconômico da ocupação do pai) influencia o destino socioeconômico (medido por variáveis como escolaridade do próprio indivíduo, status socioeconômico da ocupação e rendimento do trabalho). Este modelo é relevante para entender a transmissão intergeracional da desigualdade, muitas vezes revelando que os efeitos indiretos são mais proeminentes que os diretos .\n\n2)  **Modelo de Determinação do Índice de Gestão Descentralizada Municipal (IGD-M)**: Aplicado na área de políticas sociais, este modelo busca explicar os fatores que determinam a qualidade da gestão de programas sociais em nível municipal. Pode incluir variáveis como renda per capita, PIB per capita e a proporção de beneficiários de programas sociais, revelando a dependência municipal de recursos externos e a complexa relação entre desenvolvimento econômico e qualidade da gestão social.\n\n::: callout-note\n## Atividade\n\n**Explique os modelos acima com suas palavras a partir dos diagramas contidos no capítulo 5 de Neves (2018)**\n:::\n\n## Hands-on: Aplicação do SEM em Software Estatístico e Interpretação\n\nA aplicação prática do SEM é comumente realizada em softwares estatísticos. O pacote **`lavaan` no R** é amplamente utilizado por ser **gratuito, de código aberto e relativamente fácil de usar**. O **STATA** também emprega a abordagem por meio do comando `sem`.\n\nA sintaxe no `lavaan` é intuitiva:\n\n`~`: Usado para **previsão** (regressão), onde o resultado observado é previsto por preditores observados (e.g., `y ~ x`).\n\n`=~`: Usado para **indicadores** em modelos de mensuração, ligando uma variável latente aos seus indicadores observados (e.g., `f =~ q + r + s`).\n\n`~~`: Usado para **covariância** (e.g., `x ~~ x` para variância, `x ~~ y` para covariância).\n\n`~1`: Usado para estimar o **intercepto** ou média de uma variável (e.g., `x ~ 1`).\n\n`1*`: fixa o parâmetro ou carga fatorial em 1 (e.g., `f =~ 1*q`)\n\n`NA*`: deixa o parâmetro ou carga fatorial livre (subscreve o método padrão *marker method*, (e.g., f =\\~ NA\\*q)\n\n`a*`: fixa um valor `a` para o parâmetro (e.g., f =\\~ a\\*q)\n\n### A Base de dados: Industriaçização e Economia Política\n\nEsta base de dados, **que está contida no pacote `lavaan`**, é utilizada ao longo do livro de Bollen de 1989 (*Structural equations with latent variables*). A base de dados contém várias medidas de democracia política e industrialização em países em desenvolvimento. As variáveis podem ser descritas por:\n\n-   y1: Avaliações de especialistas sobre a liberdade de imprensa em 1960 *(em escala: 0 a 10)*\n\n-   y2: A liberdade de oposição política em 1960 *(em escala: 0 a 10)*\n\n-   y3: A imparcialidade das eleições em 1960 *(em escala: 0 a 10)*\n\n-   y4: A eficácia da legislatura eleita em 1960 *(em escala: 0 a 10)*\n\nVariáveis de Democracia Política (1965)\n\n-   y5: Avaliações de especialistas sobre a liberdade de imprensa em 1965 *(em escala: 0 a 10)*\n\n-   y6: A liberdade de oposição política em 1965 *(em escala: 0 a 10)*\n\n-   y7: A imparcialidade das eleições em 1965 *(em escala: 0 a 10)*\n\n-   y8: A eficácia da legislatura eleita em 1965 *(em escala: 0 a 10)*\n\nVariáveis de Industrialização (1960)\n\n-   x1: O produto nacional bruto (PNB) per capita em 1960\n\n-   x2: O consumo de energia per capita em 1960\n\n-   x3: A porcentagem da força de trabalho na indústria em 1960\n\n### Regressão linear:\n\nImagine que queremos estimar a relação entre: liberdade de imprensa e industrialização. A seguinte regressão foi proposta:\n\n$$\ny_1 = \\alpha_1 + \\gamma_1 x_1 + \\gamma_2 x_2 + \\gamma_3 x_3 + \\zeta_1 \n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"lavaan\")\nlibrary(\"lavaanPlot\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"PoliticalDemocracy\")\n\nm1 <- 'y1 ~ 1 + x1 + x2 + x3'\n\nfit1 <- sem(m1, data=PoliticalDemocracy)\n```\n:::\n\n\nOs resultados obtidos são:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6-19 ended normally after 1 iteration\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         5\n\n  Number of observations                            75\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  y1 ~                                                \n    x1                1.807    0.861    2.098    0.036\n    x2                0.017    0.477    0.036    0.971\n    x3               -0.307    0.382   -0.805    0.421\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .y1               -2.655    2.739   -0.970    0.332\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .y1                5.733    0.936    6.124    0.000\n```\n:::\n:::\n\n\nSe quisermos visualizar o diagrama de caminho podemos usar o comando `lavaanPlot`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlavaanPlot(model = fit1, \n           node_options = list(shape = \"box\", fontname = \"Helvetica\"), \n           edge_options = list(color = \"grey\"), \n           coefs = TRUE)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"grViz html-widget html-fill-item\" id=\"htmlwidget-c2c6c17a1742a16a0f20\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c2c6c17a1742a16a0f20\">{\"x\":{\"diagram\":\" digraph plot { \\n graph [ overlap = true, fontsize = 10 ] \\n node [ shape = box, fontname = Helvetica ] \\n node [shape = box] \\n x1; x2; x3; y1 \\n node [shape = oval] \\n  \\n \\n edge [ color = grey ] \\n x1->y1 [label = \\\"1.81\\\"] x2->y1 [label = \\\"0.02\\\"] x3->y1 [label = \\\"-0.31\\\"]  \\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nPerceba que os valores do coeficientes estimados serão os mesmo que quando usamos o `lm`. As estimativas dos erros-padrão dos coeficientes são diferentes, pois o comando `sem` utiliza outro estimador da variância do erro do modelo. *Lembre-se que o estimador da variância dos parâmetros é uma função do estimador da variância do modelo*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit1lm <- lm(y1 ~ x1 + x2 + x3, data=PoliticalDemocracy)\nsummary(fit1lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = y1 ~ x1 + x2 + x3, data = PoliticalDemocracy)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-5.1788 -1.5385  0.1764  1.7060  4.7523 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept) -2.65549    2.81464  -0.943   0.3486  \nx1           1.80655    0.88496   2.041   0.0449 *\nx2           0.01713    0.49059   0.035   0.9722  \nx3          -0.30720    0.39219  -0.783   0.4361  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.461 on 71 degrees of freedom\nMultiple R-squared:  0.1553,\tAdjusted R-squared:  0.1197 \nF-statistic: 4.353 on 3 and 71 DF,  p-value: 0.00715\n```\n:::\n:::\n\n\n::: callout-note\n## Atividade\n\n1.  **Como você interpretaria as estimativas dos parâmetros obtidos via comando `sem` do `lavaan`: de maneira diferente ou idêntica a um MQO?**\n\n2.  **No caso da estimação via `sem` de uma única equação de regressão linear como esta, existe a possibilidade do modelo não ser saturado ?**\n:::\n\n### Regressão Multivariada\n\nNessa seção vamos mostrar como rodar um modelo multivariado (2 variáveis endógenas). Por exemplo:\n\n$$\n\\begin{pmatrix}\ny_1 \\\\\ny_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\alpha_1 \\\\\n\\alpha_2\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n\\beta_{11} & \\beta_{12} & \\beta_{13} \\\\\n\\beta_{21} & \\beta_{22} & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\\nx_2 \\\\\nx_3\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n\\epsilon_1 \\\\\n\\epsilon_2\n\\end{pmatrix}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- '\n      y1 ~ 1 + x1 + x2 + x3\n      y2 ~ 1 + x1 + x2\n      x1~~x3\n      x1~~x2\n      x2~~x3\n      '\n\n\nfit2 <- sem(m2, data=PoliticalDemocracy)\n```\n:::\n\n\nOs resultados obtidos são:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6-19 ended normally after 68 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        19\n\n  Number of observations                            75\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 1\n  P-value (Chi-square)                           1.000\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  y1 ~                                                \n    x1                1.806    0.857    2.108    0.035\n    x2                0.017    0.455    0.037    0.970\n    x3               -0.307    0.307   -1.000    0.317\n  y2 ~                                                \n    x1               -0.258    1.346   -0.191    0.848\n    x2                0.765    0.653    1.172    0.241\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  x1 ~~                                               \n    x3                0.812    0.150    5.407    0.000\n    x2                0.977    0.169    5.774    0.000\n  x2 ~~                                               \n    x3                1.782    0.318    5.611    0.000\n .y1 ~~                                               \n   .y2                5.393    1.220    4.420    0.000\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .y1               -2.655    2.722   -0.976    0.329\n   .y2                1.892    4.265    0.443    0.657\n    x1                5.054    0.084   60.127    0.000\n    x2                4.792    0.173   27.657    0.000\n    x3                3.558    0.161   22.066    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .y1                5.733    0.936    6.124    0.000\n   .y2               14.404    2.352    6.124    0.000\n    x1                0.530    0.087    6.124    0.000\n    x2                2.252    0.368    6.124    0.000\n    x3                1.950    0.318    6.124    0.000\n```\n:::\n:::\n\n\nPor padrão (default) o comando `sem` admite covariação entre as variáveis endógenas, mas podemos forçar uma covariância nula:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2_1 <- '\n      y1 ~ 1 + x1 + x2 + x3\n      y2 ~ 1 + x1 + x2\n      x1~~x3\n      x1~~x2\n      x2~~x3\n      y1 ~~ 0*y2\n      '\n\n\nfit2_1 <- sem(m2_1, data=PoliticalDemocracy)\n```\n:::\n\n\nOs resultados obtidos são:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit2_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6-19 ended normally after 32 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        18\n\n  Number of observations                            75\n\nModel Test User Model:\n                                                      \n  Test statistic                                32.570\n  Degrees of freedom                                 2\n  P-value (Chi-square)                           0.000\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  y1 ~                                                \n    x1                1.807    0.861    2.098    0.036\n    x2                0.017    0.477    0.036    0.971\n    x3               -0.307    0.382   -0.805    0.421\n  y2 ~                                                \n    x1               -0.258    1.346   -0.191    0.848\n    x2                0.765    0.653    1.172    0.241\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  x1 ~~                                               \n    x3                0.812    0.150    5.407    0.000\n    x2                0.977    0.169    5.774    0.000\n  x2 ~~                                               \n    x3                1.782    0.318    5.611    0.000\n .y1 ~~                                               \n   .y2                0.000                           \n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .y1               -2.655    2.739   -0.970    0.332\n   .y2                1.892    4.265    0.443    0.657\n    x1                5.054    0.084   60.127    0.000\n    x2                4.792    0.173   27.657    0.000\n    x3                3.558    0.161   22.066    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .y1                5.733    0.936    6.124    0.000\n   .y2               14.404    2.352    6.124    0.000\n    x1                0.530    0.087    6.124    0.000\n    x2                2.252    0.368    6.124    0.000\n    x3                1.950    0.318    6.124    0.000\n```\n:::\n:::\n\n\n::: callout-note\n## Atividade\n\n1.  **Compare os modelos fit2 com o fit2_1. Explique o que aconteceu com os graus de liberdade?**\n\n2.  **Proponha uma especificação no `lavaan` que torne a regressão multivariada saturada.**\n\n3.  **Proponha uma especificação no `lavaan`que gere as mesmas estimativas que 2 regressões independentes por `lm`.**\\\n:::\n\n### Modelo de Mensuração\n\nImagine que a intenção seja, a partir, das variáveis $x_1$, $x_2$ e $x_3$, mensurar um fator latente da industrialização em 1960.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- '\n      ind60 =~ x1 + x2 + x3\n      '\n\nfit3 <- sem(m3, data=PoliticalDemocracy)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6-19 ended normally after 22 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         6\n\n  Number of observations                            75\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  ind60 =~                                            \n    x1                1.000                           \n    x2                2.193    0.142   15.403    0.000\n    x3                1.824    0.153   11.883    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.084    0.020    4.140    0.000\n   .x2                0.108    0.074    1.455    0.146\n   .x3                0.468    0.091    5.124    0.000\n    ind60             0.446    0.087    5.135    0.000\n```\n:::\n:::\n\n\nPerceba que a interpretação das cargas fatoriais é pouco informativa: **a unidade de medida de** $x_2$ e $x_3$ não é a mesma Por isso é comum a padronização das variáveis para tornar a unidade de medida em desvios-padrão:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit3, standardized=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6-19 ended normally after 22 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         6\n\n  Number of observations                            75\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n  ind60 =~                                                              \n    x1                1.000                               0.667    0.917\n    x2                2.193    0.142   15.403    0.000    1.464    0.976\n    x3                1.824    0.153   11.883    0.000    1.217    0.872\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n   .x1                0.084    0.020    4.140    0.000    0.084    0.159\n   .x2                0.108    0.074    1.455    0.146    0.108    0.048\n   .x3                0.468    0.091    5.124    0.000    0.468    0.240\n    ind60             0.446    0.087    5.135    0.000    1.000    1.000\n```\n:::\n:::\n\n\n`Std.lv` padroniza apenas o fator latente, deixando as variáveis observadas em suas escalas originais, permitindo interpretar o impacto de 1 desvio padrão no construto sobre os indicadores. Já `Std.all` padroniza tanto o fator quanto os indicadores, tornando as cargas fatoriais coeficientes de correlação entre -1 e +1, ideal para comparar a força relativa dos indicadores e avaliar sua validade.\n\n::: callout-note\n## Atividade\n\n1.  **Ao invés de utilizar o método do marcador replique o modelo `m3` utilizando o método de padronização da variância.**\\\n:::\n\n### Modelo de Regressão Estrutural\n\nVamos agora rodar um modelo de regrassão estrutural. Imagine que a teoria nos diga que a industrialização em 1960 seja um preditor do ambiente democrático em 1960 e em 1965. Imagine, também, que o ambiente democrático em 1960 explique o ambiente democrático em 1965.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- '\n  # measurement model\n    ind60 =~ x1 + x2 + x3\n    dem60 =~ y1 + y2 + y3 + y4\n    dem65 =~ y5 + y6 + y7 + y8\n  # regressions\n    dem60 ~ ind60\n    dem65 ~ ind60 + dem60\n  # residual correlations\n    y1 ~~ y5\n    y2 ~~ y4 + y6\n    y3 ~~ y7\n    y4 ~~ y8\n    y6 ~~ y8'\nfit <- sem(model, data=PoliticalDemocracy)\nsummary(fit, standardized=TRUE, fit.measures=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6-19 ended normally after 68 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        31\n\n  Number of observations                            75\n\nModel Test User Model:\n                                                      \n  Test statistic                                38.125\n  Degrees of freedom                                35\n  P-value (Chi-square)                           0.329\n\nModel Test Baseline Model:\n\n  Test statistic                               730.654\n  Degrees of freedom                                55\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.995\n  Tucker-Lewis Index (TLI)                       0.993\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -1547.791\n  Loglikelihood unrestricted model (H1)      -1528.728\n                                                      \n  Akaike (AIC)                                3157.582\n  Bayesian (BIC)                              3229.424\n  Sample-size adjusted Bayesian (SABIC)       3131.720\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.035\n  90 Percent confidence interval - lower         0.000\n  90 Percent confidence interval - upper         0.092\n  P-value H_0: RMSEA <= 0.050                    0.611\n  P-value H_0: RMSEA >= 0.080                    0.114\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.044\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n  ind60 =~                                                              \n    x1                1.000                               0.670    0.920\n    x2                2.180    0.139   15.742    0.000    1.460    0.973\n    x3                1.819    0.152   11.967    0.000    1.218    0.872\n  dem60 =~                                                              \n    y1                1.000                               2.223    0.850\n    y2                1.257    0.182    6.889    0.000    2.794    0.717\n    y3                1.058    0.151    6.987    0.000    2.351    0.722\n    y4                1.265    0.145    8.722    0.000    2.812    0.846\n  dem65 =~                                                              \n    y5                1.000                               2.103    0.808\n    y6                1.186    0.169    7.024    0.000    2.493    0.746\n    y7                1.280    0.160    8.002    0.000    2.691    0.824\n    y8                1.266    0.158    8.007    0.000    2.662    0.828\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n  dem60 ~                                                               \n    ind60             1.483    0.399    3.715    0.000    0.447    0.447\n  dem65 ~                                                               \n    ind60             0.572    0.221    2.586    0.010    0.182    0.182\n    dem60             0.837    0.098    8.514    0.000    0.885    0.885\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n .y1 ~~                                                                 \n   .y5                0.624    0.358    1.741    0.082    0.624    0.296\n .y2 ~~                                                                 \n   .y4                1.313    0.702    1.871    0.061    1.313    0.273\n   .y6                2.153    0.734    2.934    0.003    2.153    0.356\n .y3 ~~                                                                 \n   .y7                0.795    0.608    1.308    0.191    0.795    0.191\n .y4 ~~                                                                 \n   .y8                0.348    0.442    0.787    0.431    0.348    0.109\n .y6 ~~                                                                 \n   .y8                1.356    0.568    2.386    0.017    1.356    0.338\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n   .x1                0.082    0.019    4.184    0.000    0.082    0.154\n   .x2                0.120    0.070    1.718    0.086    0.120    0.053\n   .x3                0.467    0.090    5.177    0.000    0.467    0.239\n   .y1                1.891    0.444    4.256    0.000    1.891    0.277\n   .y2                7.373    1.374    5.366    0.000    7.373    0.486\n   .y3                5.067    0.952    5.324    0.000    5.067    0.478\n   .y4                3.148    0.739    4.261    0.000    3.148    0.285\n   .y5                2.351    0.480    4.895    0.000    2.351    0.347\n   .y6                4.954    0.914    5.419    0.000    4.954    0.443\n   .y7                3.431    0.713    4.814    0.000    3.431    0.322\n   .y8                3.254    0.695    4.685    0.000    3.254    0.315\n    ind60             0.448    0.087    5.173    0.000    1.000    1.000\n   .dem60             3.956    0.921    4.295    0.000    0.800    0.800\n   .dem65             0.172    0.215    0.803    0.422    0.039    0.039\n```\n:::\n:::\n\n\nA opção `fit.measures=TRUE` faz com que o comando reporte estatísticas de testes que analisam o ajuste do modelo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlavaanPlot(model = fit, \n           node_options = list(shape = \"box\", fontname = \"Helvetica\"),\n           graph_options = list(rankdir = \"LR\"),\n           edge_options = list(color = \"grey\"),\n           stars =  \"regress\",\n           covs = TRUE,\n           coefs = TRUE)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"grViz html-widget html-fill-item\" id=\"htmlwidget-bd99f38bfbd671d490bb\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-bd99f38bfbd671d490bb\">{\"x\":{\"diagram\":\" digraph plot { \\n graph [ rankdir = LR ] \\n node [ shape = box, fontname = Helvetica ] \\n node [shape = box] \\n x1; x2; x3; y1; y2; y3; y4; y5; y6; y7; y8 \\n node [shape = oval] \\n ind60; dem60; dem65 \\n \\n edge [ color = grey ] \\n ind60->dem60 [label = \\\"1.48***\\\"] ind60->dem65 [label = \\\"0.57**\\\"] dem60->dem65 [label = \\\"0.84***\\\"] ind60->x1 [label = \\\"1\\\"] ind60->x2 [label = \\\"2.18\\\"] ind60->x3 [label = \\\"1.82\\\"] dem60->y1 [label = \\\"1\\\"] dem60->y2 [label = \\\"1.26\\\"] dem60->y3 [label = \\\"1.06\\\"] dem60->y4 [label = \\\"1.26\\\"] dem65->y5 [label = \\\"1\\\"] dem65->y6 [label = \\\"1.19\\\"] dem65->y7 [label = \\\"1.28\\\"] dem65->y8 [label = \\\"1.27\\\"] y5 -> y1 [label = \\\"0.62\\\", dir = \\\"both\\\"] y4 -> y2 [label = \\\"1.31\\\", dir = \\\"both\\\"] y6 -> y2 [label = \\\"2.15\\\", dir = \\\"both\\\"] y7 -> y3 [label = \\\"0.79\\\", dir = \\\"both\\\"] y8 -> y4 [label = \\\"0.35\\\", dir = \\\"both\\\"] y8 -> y6 [label = \\\"1.36\\\", dir = \\\"both\\\"]\\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nUma forma de analisar o ajuste do modelo é pelo qui-quadrado. A estatística desse teste é calculada a partir do *score* da função de máxima verossimilhança\n\nQuanto maior o valor do qui-quadrado, maior a diferença entre a matriz de covariância implícita da amostra $\\Sigma(\\theta)$ e a matriz de covariância observada da amostra $S$, e maior a probabilidade de você rejeitar seu modelo. A hipótese nula é: $$\nH_0: \\Sigma(\\theta) = \\Sigma \n$$ $$\nH_1: \\Sigma(\\theta) \\ne \\Sigma\n$$\n\nComo no teste qui-quadrado, a estatística é computada pelo produto do número de observações e do *score* da função de máxima verossimilhança, dizemos que é um teste sensível ao tamanho da amostra (amostras muito grandes tendem a gerar estatísticas do teste maiores e p-valores menores).\n\nPor esse motivo é comum a utilização de medidas de ajuste do modelo comparativas. O `lavaan` reporta 2:\n\n1.  Comparative Fit Index (CFI)\n\n-   O teste compara a estatística do teste qui-quadrado entre 2 modelos: o modelo utilizado e o modelo *baseline*, isto é, aquele que não admite relações/covariâncias entre as variáveis (apenas variância). Seja $\\delta$ = $\\chi^2 - df$ a diferença entre a estatística qui-quadrado e graus de liberdade, o CFI é calculado por:\n\n$$\nCFI = \\frac{\\delta_{baseline}-\\delta_{usado}}{\\delta_{baseline}}\n$$ Quanto mais próximo o valor do CFI de 1, melhor o ajuste do modelo: no limite queremos minimizar a diferença entre a matriz de covariância implícita da amostra $\\Sigma(\\theta)$ e a matriz de covariância observada da amostra $S$, ou seja, $\\chi^2 \\rightarrow 0$ modelando todas as relações entre as variáveis, $df \\rightarrow 0$\n\n2.  Tucker Lewis Index (TLI)\n\n-   O teste tem a mesma ideia do CFI, mas a ponderação pelos graus de liberdade é diferente. Seja $\\Delta$ = $\\frac{\\chi^2}{df}$ a diferença entre a estatística qui-quadrado e graus de liberdade, o TLI é calculado por:\n\n$$\nTLI = \\frac{\\Delta_{baseline}-\\Delta_{usado}}{\\Delta_{baseline}-1}\n$$ Quanto mais próximo o valor do TLI de 1, melhor o ajuste do modelo\n\n::: callout-note\n## Atividade\n\n**Compute o TLI e o CFI na mão. Compare com os resultados obtidos no 'lavaan'**\n:::\n\n## Discussão: Limitações e Desafios do SEM\n\nA grande limitação do SEM nas Ciências Econômicas diz respeito à sua capacidade como instrumento para inferência causal\n\nNa discussão **Resultados Potenciais vs SEM**, encabeçada por Judea Pearl, o SEM sai em desvantagem, pois a Economia ainda é uma ciência preocupada em provar causação (devido aos seus paradigmas de pensamento). O SEM não é adequado para provar causação, mas pode interpretar parâmetros como efeitos causais.\n\nNesse sentido, o SEM seria mais adequado como uma abordagem complementar a um experimento realizado anteriormente para garantir a causação.\n\n# Avaliação\n\n::: callout-note\nComo parte da nota da disciplina responda às seguintes questões:\n\n1.  Qual é a principal diferença entre uma variável observada e uma variável latente em um Modelo de Equações Estruturais (SEM)? Forneça um exemplo em um contexto econômico.\n\n2.  Explique a distinção entre o modelo de mensuração e o modelo estrutural em um SEM.\n\n3.  Quais são as vantagens de se utilizar um SEM em comparação com uma análise de regressão múltipla tradicional para analisar relações complexas na Economia?\n\n4.  Utilize o pacote lavaan para exemplificar o modelo de equações estruturais (os dados não precisam ser reais). Compartilhe o projeto com o professor via Posit Cloud.\n:::\n\n# Referências\n\n-   NEVES, J. A. B. **Modelo de equações estruturais: uma introdução aplicada**. Brasília: Enap, 2018.\n\n-   RAYKOV, T.; MARCOULIDES, G. A. A first course in structural equation modeling. routledge, 2012.\n\n-   UNIVERSITY OF CALIFORNIA, LOS ANGELES. Statistical Consulting Group. **Introduction to Structural Equation Modeling (SEM) in R with lavaan**. Disponível em: https://stats.oarc.ucla.edu/r/seminars/rsem/introduction-to-sem-in-r-with-lavaan/. Acesso em: 9 jul. 2025.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/viz-1.8.2/viz.js\"></script>\r\n<link href=\"../../site_libs/DiagrammeR-styles-0.2/styles.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/grViz-binding-1.0.11/grViz.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}