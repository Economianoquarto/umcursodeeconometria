---
title: "Modelo de Equações Estruturais"
author: "Caio Lopes"
date: "2025-07-17"
categories: [Aulas]
image: "image.jpg"
---

# Descrição

Este material aborda os Modelos de Equações Estruturais (MEE) ou *Structural Equation Model* (SEM)

# Introdução

## O que é o SEM?

A Modelagem de Equações Estruturais (SEM) é uma técnica estatística multivariada extremamente poderosa usada para testar e estimar relações de causalidade entre múltiplas variáveis. Ela combina aspectos da análise fatorial (que lida com variáveis latentes, ou seja, conceitos não observáveis diretamente, como "satisfação" ou "inteligência") e da análise de regressão múltipla (que analisa as relações de dependência entre variáveis).

Um modelo SEM é geralmente representado por um diagrama que mostra as relações hipotéticas entre: **Variáveis Latentes** e **Variáveis Observadas**

- **Variáveis Latentes**: Conceitos abstratos que não podem ser medidos diretamente (ex: bem-estar, inteligência, burnout).

- **Variáveis Observadas (ou Indicadores)**: Dados que podem ser medidos diretamente e que servem como indicadores das variáveis latentes (ex: respostas a perguntas de um questionário).

O SEM pode ser visto como uma **combinação de análise fatorial e regressão** 

A análise fatorial pode ser dividida em dois tipos principais: exploratória e confirmatória.

- **A análise fatorial exploratória**, também conhecida como AFE, como o nome sugere, é uma ferramenta exploratória para entender as traços latentes (atributos psicológicos) subjacentes de uma escala desconhecida. 

- **A análise fatorial confirmatória** toma emprestados muitos dos mesmos conceitos da análise fatorial exploratória, exceto que, em vez de deixar os dados nos dizerem a estrutura fatorial, nós pré-determinamos a estrutura fat orial e verificamos a estrutura latente de uma escala previamente desenvolvida.

**A análise fatorial confirmatória - ou confirmatory factor analysis  (CFA) - participa frequentemente da abordagem guarda-chuva do SEM**

## Por que utilizar o SEM?

**Visão Holística do Modelo**
Use a SEM para testar um sistema completo de relações de uma só vez. Em vez de analisar cada hipótese separadamente (o que aumenta o risco de erro), a SEM avalia se o seu modelo teórico como um todo é compatível com os dados, oferecendo uma visão global e integrada do fenômeno.

**Medição Precisa de Conceitos Abstratos**
A SEM é ideal para medir conceitos abstratos (variáveis latentes) como "satisfação" ou "ansiedade". Ela faz isso usando múltiplos indicadores (perguntas de um questionário) e, crucialmente, separa a medição do conceito do seu erro de medição. Isso resulta em estimativas muito mais puras e confiáveis das relações entre as variáveis.

## Quando usar o SEM?

A Modelagem de Equações Estruturais é uma ferramenta estatística confirmatória, não exploratória. Ela pode ser aplicada de três maneiras distintas:

- I. *Confirmação Direta*: Testar um único modelo teórico para validá-lo ou invalidá-lo.

- II. *Modelos Alternativos*: Comparar modelos concorrentes para ver qual explica melhor os dados.

- III. *Desenvolvimento do Modelo*: Iniciar com um modelo teórico e, caso ele não se ajuste bem, modificá-lo em busca de uma versão melhor e mais simples (parcimoniosa).

## Vantagem do SEM

Os Modelos de Equações Estruturais englobam uma ampla gama de abordagens: 

-  **Regressão linear e multivariada**
-  **Análise de trajetória (path analysis)**
-  **Análise fatorial confirmatória (CFA)**
-  **Regressão estrutural** 

Essa abordagem Guarda-chuva representa sua maior vantagem

## Breve histórico do SEM

Os fundamentos técnicos de todos os modelos SEM são baseados na notação clássica LISREL (linear structural relations) em homenagem a **Karl Joreskög**, que a inventou em 1969 e 1973. Embora o SEM seja considerado um campo relativamente novo na estatística, com base em 1976, todas as implementações modernas do SEM são derivações do LISREL, seja expandindo suas capacidades ou simplificando sua complexidade. A compreensão da notação LISREL é, portanto, fundamental para entender as estruturas mais recentes do SEM.

# Conceitos e a Caixa de Ferramentas

Para trabalhar com SEM, é essencial compreender seus componentes e a terminologia específica.

Este quadro apresenta os principais termos utilizados em Modelagem de Equações Estruturais (SEM) de forma concisa e visual.

| Termo | Definição | Exemplo |
|:---|:---|:---|
| **Variável Observada** | Variável que **existe no banco de dados**, diretamente medida ou coletada. Também chamada de **item** ou **variável manifesta**. | Resposta a "Qual sua nota em matemática?" ou "De 1 a 5, quão satisfeito você está?". |
| **Variável Latente** | **Conceito abstrato não medido diretamente**, inferido a partir de variáveis observadas. | "Inteligência", "Ansiedade", "Satisfação no Trabalho". |
| **Variável Exógena** | **Variável independente** no modelo, funciona como "causa" e não é explicada por outras variáveis no modelo. | Ponto de partida de uma seta causal. |
| **Variável Endógena** | **Variável dependente** no modelo, funciona como "efeito" e é explicada por outras variáveis no modelo. | Destino de uma seta causal. |
| **Modelo de Mensuração** | Parte do SEM que **conecta variáveis observadas a variáveis latentes**, definindo como os conceitos abstratos são medidos. | Especificar que Q1, Q2 e Q3 são indicadores de "Ansiedade". |
| **Indicador** | **Variável observada usada para medir uma variável latente** em um modelo de mensuração. | "Nota em geometria" como medida de "habilidade matemática". |
| **Fator** | Outro nome para **variável latente**, definida por seus indicadores. | "Inteligência" como fator medido por testes de QI. |
| **Carga Fatorial** | Caminho que **liga um indicador ao seu fator**, representando a força dessa relação. | Uma carga fatorial alta indica que o item é um bom medidor do conceito. |
| **Modelo Estrutural** | Parte do SEM que **especifica relações de causa e efeito entre variáveis** (latentes ou observadas). | Definir "Ansiedade → Desempenho Acadêmico". |

## Variáveis Observadas vs. Variáveis Latentes

No SEM, distinguimos entre dois tipos principais de variáveis : **Variáveis Observadas**: São variáveis que **existem diretamente nos dados** e podem ser medidas sem erro. 

**Variáveis Latentes**: São variáveis **construídas e que não existem diretamente nos dados**; são hipóteses teóricas. Elas são mensuradas indiretamente através de suas variáveis observadas (indicadores) por meio de análise fatorial confirmatória

Além disso, as variáveis podem ser classificadas como: 

**Variável Exógena**: Uma variável **independente** que explica uma variável endógena. Pode ser observada (representada por 'x') ou latente (representada por '$\xi$').  

**Variável Endógena**: Uma variável **dependente** que é explicada por outras variáveis no modelo. Pode ser observada (representada por 'y') ou latente (representada por '$\eta$'). Em modelos de análise de trajetória, uma variável endógena pode predizer outra variável endógena.

## Diagramas de Caminho ou Diagramas de Trajetória 

Os **diagramas de trajetória** são representações visuais essenciais dos modelos SEM, facilitando a compreensão das relações complexas que podem ser difíceis de visualizar apenas com equações matriciais.

![Exemplo de diagrama de trajetória](legenda_diagrama.png)

Os símbolos utilizados nos diagramas são padronizados:  **Círculos**: Representam **variáveis latentes** (fatores ou construtos). **Quadrados**: Representam **variáveis observadas** (indicadores ou itens). **Triângulos**: Representam **interceptos** ou médias (geralmente não explicitados por padrão no `lavaan` a menos que solicitados).  **Setas únicas (de uma via)**: Indicam **caminhos de regressão** ou relações causais diretas (ex: uma variável predizendo outra). **Setas duplas (de duas vias)**: Indicam **variâncias** (se a seta aponta para a própria variável, formando um loop) ou **covariâncias** (se a seta conecta duas variáveis) .

**Exemplo de leitura de um diagrama**:  Uma seta de um círculo para um quadrado indica que uma variável latente (fator) prediz uma variável observada (indicador), o que é parte de um **modelo de mensuração ou medida**. Uma seta dupla em um círculo ou quadrado representa a variância daquela variável (latente ou observada).  Uma seta dupla entre dois círculos ou dois quadrados indica a covariância entre essas duas variáveis.

## Modelo de Mensuração e Modelo Estrutural

O SEM é singular por abranger tanto **modelos de medida ou  de mensuração** quanto **modelos estruturais**:

-   **Modelo de Mensuração**: É a parte do SEM que **liga variáveis observadas a variáveis latentes**. Sua função é mensurar construtos latentes a partir de variáveis observadas . Envolve a **Análise Fatorial Confirmatória (AFC)**.
    -   Neste modelo, as variáveis observadas que medem um fator são chamadas de **indicadores**.
    -   Um fator (variável latente) é definido por seus indicadores. A relação entre um indicador e um fator é chamada de **carga fatorial (loading)**.
-   **Modelo Estrutural**: A parte do SEM que **especifica as relações causais entre variáveis**, sejam elas observadas ou latentes. Pode envolver relações de variáveis exógenas para endógenas, e até mesmo de variáveis endógenas para outras variáveis endógenas.
    -   O tipo mais abrangente de modelo estrutural, a **regressão estrutural**, lida com as relações entre **variáveis latentes**.
    -   As relações são definidas por coeficientes de regressão: $\Gamma$ (Gamma) para relações de variáveis exógenas para endógenas, e $B$ (Beta) para relações de variáveis endógenas para outras variáveis endógenas.

## Estimação (Máxima Verossimilhança) e Teste de Modelos (Goodness-of-Fit)

### Estimação

No SEM, os modelos são tipicamente estimados utilizando o método de **Máxima Verossimilhança (ML)**. A ML busca os parâmetros que tornam a amostra observada mais provável, ou seja, maximiza a função de verossimilhança para determinar os parâmetros que têm maior probabilidade de produzir os dados observados. É importante notar que, embora os coeficientes de regressão de uma estimação por Mínimos Quadrados Ordinários (MQO) sejam equivalentes aos da Máxima Verossimilhança, as **variâncias residuais podem diferir ligeiramente** devido às diferentes bases de cálculo (divisão por $N-k$ para MQO e $N$ para ML).

O componente mais essencial de um modelo de equações estruturais é a **matriz de covariância**. O objetivo do SEM é **reproduzir a matriz de covariância da população (**$\Sigma$) usando os parâmetros que o modelo hipotetiza ($\Sigma(\theta)$), conhecida como matriz de covariância implicada pelo modelo. Se o modelo se ajusta perfeitamente, então $\Sigma = \Sigma(\theta)$.

### Identificação do Modelo

A identificação de um modelo SEM é crucial para garantir que os parâmetros possam ser estimados de forma única. Modelos podem ser classificados como: 

- **Sub-identificados**: O número de valores conhecidos é menor que o número de parâmetros livres ($df < 0$). **Não há solução única para a estimação**.  

- **Justamente Identificados (ou Saturados)**: O número de valores conhecidos é igual ao número de parâmetros livres ($df = 0$). **O modelo se ajusta perfeitamente aos dados**.Modelos de regressão linear simples e múltipla são exemplos de modelos saturados .

- **Sobre-identificados**: O número de valores conhecidos é maior que o número de parâmetros livres ($df > 0$). **O modelo não se ajusta perfeitamente, mas permite a avaliação da qualidade do ajuste**. **Modelos sobre-identificados são considerados "bons"**, pois permitem avaliar o ajuste do modelo .

Para modelos de análise fatorial (medida), a identificação do fator é particularmente importante, pois variáveis latentes não são observadas diretamente. Para um modelo com três ou mais indicadores, existem duas abordagens principais para identificação: 

- 1. **Método do Marcador (Marker Method)**: Fixa a **primeira carga fatorial de cada fator em 1**. Este é o método padrão no `lavaan` .

- 2. **Método de Padronização da Variância (Variance Standardization Method)**: Fixa a **variância de cada fator em 1**, mas estima livremente todas as cargas fatoriais . Este método é considerado mais padronizado e útil para interpretação.

### Estatísticas de Qualidade do Ajuste (Model Fit Statistics)

As estatísticas de qualidade do ajuste avaliam o quão bem o modelo populacional se ajusta aos dados observados. A hipótese nula no SEM é que **a matriz de covariância implicada pelo modelo (**$\Sigma(\theta)$) é igual à matriz de covariância da população ($\Sigma$) ($H_0: \Sigma(\theta)=\Sigma$). Rejeitar esta hipótese é geralmente **indesejável** no SEM, pois significaria que o modelo proposto não se ajusta bem aos dados.

-   **Covariância Residual**: A diferença entre a matriz de covariância amostral ($S$) e a matriz de covariância implicada pelo modelo ($\Sigma(\hat{\theta})$), ou seja, $S - \Sigma(\hat{\theta})$. Valores próximos de zero indicam um bom ajuste.

-   **Teste Chi-quadrado do Modelo (**$\chi^2$): É a estatística de teste principal que mede a discrepância entre a matriz de covariância observada e a matriz de covariância implicada pelo modelo \[28, 66, 68, 69\].

    -   Um **valor de chi-quadrado maior indica uma maior diferença** (pior ajuste) entre as matrizes e, consequentemente, uma maior probabilidade de rejeitar a hipótese nula \[68, 70\].
    -   **Sensibilidade ao tamanho da amostra**: O teste chi-quadrado é **altamente sensível a amostras grandes**. Em amostras grandes, é comum que o teste seja estatisticamente significativo mesmo para modelos com bom ajuste prático . Por isso, o chi-quadrado sozinho não deve ser o único critério de avaliação de ajuste.

-   **Modelo de Linha de Base (Baseline Model)**: Considerado o **modelo de "pior ajuste"**. Ele assume que não há covariância entre quaisquer variáveis, estimando apenas as variâncias de cada uma. Serve como ponto de comparação para os índices de ajuste incrementais.

-   **Índices de Ajuste Aproximados**: Desenvolvidos para complementar o teste chi-quadrado, atenuando sua sensibilidade ao tamanho da amostra.

    -   **Índices de Ajuste Incrementais (ou Relativos)**: Avaliam a melhoria do ajuste do modelo do usuário em relação ao modelo de linha de base.
    -   **CFI (Comparative Fit Index)**: Varia de 0 a 1. Valores **maiores que 0.90 (conservadoramente 0.95) indicam bom ajuste**. Quanto mais próximo de 1, melhor o ajuste.
    -   **TLI (Tucker-Lewis Index)**: Também varia de 0 a 1 (valores maiores que 1 são arredondados para 1). Valores **maiores que 0.90 indicam bom ajuste**. O TLI utiliza a "chi-quadrado relativa" ($\chi^2/df$), onde $\chi^2/df = 1$ indica ajuste perfeito, e valores acima de 2 ou 5 podem indicar ajuste inadequado.
    -   **Índices de Ajuste Absolutos**: Avaliam o ajuste do modelo diretamente em relação aos dados observados, sem comparação com um modelo de linha de base.
    -   **RMSEA (Root Mean Square Error of Approximation)**: Mede o erro de aproximação. Valores $\le 0.05$ indicam um ajuste próximo, entre $0.05$ e $0.08$ indicam um ajuste razoável, e $\ge 0.10$ indicam um ajuste ruim.

-   **Índice de Modificação (MI)**: É um teste de qui-quadrado de 1 grau de liberdade que avalia o quanto o chi-quadrado do modelo mudaria se um parâmetro específico fosse incluído. MIs elevados sugerem um grande impacto na melhoria do ajuste.

    -   **Cuidado**: A modificação do modelo com base exclusivamente no MI **deve ser feita com justificativa teórica**, para evitar a superestimação do ajuste e o aumento do Erro Tipo I (falsos positivos).

# Aplicações do SEM na Economia

O SEM, com sua capacidade de modelar relações complexas e variáveis latentes, tem diversas aplicações.

## Exemplos de Aplicações

Dois exemplos clássicos de aplicação são:  

1) **Modelo de Realização de Status Socioeconômico**: Um modelo da teoria da estratificação social que investiga como a origem socioeconômica (variáveis como escolaridade dos pais e status socioeconômico da ocupação do pai) influencia o destino socioeconômico (medido por variáveis como escolaridade do próprio indivíduo, status socioeconômico da ocupação e rendimento do trabalho). Este modelo é relevante para entender a **transmissão intergeracional da desigualdade**, muitas vezes revelando que os efeitos indiretos são mais proeminentes que os diretos . 

**Modelo de Determinação do Índice de Gestão Descentralizada Municipal (IGD-M)**: Aplicado na área de políticas sociais, este modelo busca explicar os fatores que determinam a qualidade da gestão de programas sociais em nível municipal. Pode incluir variáveis como renda per capita, PIB per capita e a proporção de beneficiários de programas sociais, revelando a dependência municipal de recursos externos e a complexa relação entre desenvolvimento econômico e qualidade da gestão social.

## Hands-on: Aplicação do SEM em Software Estatístico

A aplicação prática do SEM é comumente realizada em softwares estatísticos. O pacote **`lavaan` no R** é amplamente utilizado por ser **gratuito, de código aberto e relativamente fácil de usar**. O **STATA** também emprega a aboradagem por meio do comando `SEM`.

A sintaxe no `lavaan` é intuitiva: 

`~`: Usado para **previsão** (regressão), onde o resultado observado é previsto por preditores observados (e.g., `y ~ x`). 

`=~`: Usado para **indicadores** em modelos de mensuração, ligando uma variável latente aos seus indicadores observados (e.g., `f =~ q + r + s`). 

`~~`: Usado para **covariância** (e.g., `x ~~ x` para variância, `x ~~ y` para covariância). 

`~1`: Usado para estimar o **intercepto** ou média de uma variável (e.g., `x ~ 1`).


```{r}
#| message: false
#| warning: false

library("lavaan")
library("lavaanPlot")

data("PoliticalDemocracy")

m1 <- 'y1 ~ 1 + x1 + x2 + x3'

fit1 <- sem(m1, data=PoliticalDemocracy)
```
Os resultados obtidos são: 
```{r}
#| echo: true
summary(fit1)
```


```{r}
#| echo: true
lavaanPlot(model = fit1, 
           node_options = list(shape = "box", fontname = "Helvetica"), 
           edge_options = list(color = "grey"), 
           coefs = TRUE)
```

## Análise e Interpretação dos Parâmetros Estimados

A interpretação dos resultados de um modelo SEM envolve a análise de diferentes tipos de coeficientes e estatísticas:

-   **Coeficientes de Regressão (Caminhos Estruturais)**:
    -   **Caminhos** $\Gamma$ (Gamma): Representam a relação entre **variáveis exógenas e variáveis endógenas** (observadas ou latentes) \[44, 105-107\].
    -   **Caminhos** $B$ (Beta): Representam a relação entre **variáveis endógenas e outras variáveis endógenas** (observadas ou latentes) \[43, 44, 108, 109\].
-   **Cargas Fatoriais (Loadings,** $\Lambda$):
    -   Indicam a **associação específica entre os fatores (variáveis latentes) e suas variáveis observadas (indicadores)** \[33, 35, 37, 110\].
    -   Em termos padronizados (similar a correlações), cargas fatoriais **próximas de 0.8 são consideradas boas**, enquanto valores próximos de 0.4 podem ser questionáveis \[62\]. Cargas elevadas (e.g., \> 0.70 ou 0.80) são geralmente desejáveis e indicam que as variáveis observadas convergem satisfatoriamente para formar o construto \[111-113\].
-   **Variâncias e Covariâncias**:
    -   **Variância de variáveis exógenas (**$\Phi$): A variância de uma variável exógena (observada ou latente) \[105, 106\].
    -   **Variância Residual de variáveis endógenas (**$\Psi$): A variância não explicada da variável endógena após considerar a influência de seus preditores \[105, 106, 114\]. É o que "sobra" da previsão \[115, 116\].
    -   **Variância Residual de Indicadores (**$\Theta$): No modelo de mensuração, é a variância não explicada dos indicadores após a influência do fator latente \[39, 110\].
    -   A presença de um "." (ponto) antes do nome da variável na saída do `lavaan` geralmente indica uma variável endógena ou uma variância residual \[114, 117\].
-   **Coeficientes Padronizados**: Facilitam a interpretação e a comparação da magnitude dos efeitos entre diferentes variáveis, pois transformam as variáveis para uma mesma escala (desvios padrão) \[9, 71\].

## Discussão: Limitações e Desafios do SEM

Apesar de suas muitas vantagens, a aplicação do SEM também apresenta desafios e limitações \[88, 118\]:

-   **Requisito de Teoria Forte**: O SEM é uma abordagem confirmatória, o que significa que ele exige uma **sólida base teórica** para a especificação do modelo inicial \[13, 15\]. O sucesso de uma análise SEM depende da adequação da teoria subjacente; **erros teóricos ou conceituais não podem ser corrigidos apenas por análises estatísticas** \[119\].
-   **Desafio da Causalidade**: Embora o SEM seja amplamente utilizado para análises causais \[120, 121\], estabelecer a causalidade definitiva requer a satisfação de três condições principais: associação estatística, precedência temporal e eliminação de causas concorrentes \[122\]. A última, em particular, é difícil de ser plenamente garantida com dados observacionais \[123\].
-   **Sensibilidade ao Tamanho da Amostra**: O teste chi-quadrado do modelo, um dos principais indicadores de ajuste, é **muito sensível a amostras grandes**, o que pode levar à sua rejeição mesmo para modelos bem ajustados na prática \[68, 70-72\]. Recomenda-se uma proporção de 20 observações para cada parâmetro estimado no modelo ($N:q$ rule) \[124\].
-   **Uso Criterioso dos Índices de Modificação**: Embora os índices de modificação possam sugerir melhorias no modelo, seu **uso excessivo ou sem justificativa teórica pode levar a modelos espúrios** e aumentar o Erro Tipo I (falsos positivos), comprometendo a replicabilidade dos resultados \[84-87\].
-   **Complexidade de Interpretação (LISREL)**: A notação LISREL original pode ser complexa \[12, 17\]. No entanto, softwares modernos como `lavaan` simplificaram essa complexidade, tornando o SEM mais acessível \[17, 103\].

------------------------------------------------------------------------

# Referências

-   \[125\] NEVES, J. A. B. **Modelo de equações estruturais: uma introdução aplicada**. Brasília: Enap, 2018.
-   \[5\] UNIVERSITY OF CALIFORNIA, LOS ANGELES. Statistical Consulting Group. **Introduction to Structural Equation Modeling (SEM) in R with lavaan**. Disponível em: https://stats.oarc.ucla.edu/r/seminars/rsem/introduction-to-sem-in-r-with-lavaan/. Acesso em: 9 jul. 2025.
-   \[126\] UCLA Office of Advanced Research Computing (OARC). **Introduction to Structural Equation Modeling**. \[Vídeo no YouTube\]
